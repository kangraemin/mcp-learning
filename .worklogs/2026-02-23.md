# Worklog: mcp — 2026-02-23

---

## 10:44 (auto)

### 작업 내용
- feat: 스토리지를 SQLite에서 로컬 마크다운 파일로 전환
- - storage.py 신규 작성: data/tils/YYYY-MM-DD-{slug}.md 파일 기반 CRUD
- - python-frontmatter 라이브러리로 YAML frontmatter 처리
- - tools.py: save_discussion_recap tool 추가 (저장 후 git commit/push 자동 실행)
- - prompts.py: discussion_recap 프롬프트 추가
- - resources.py, server.py: db 모듈 → storage 모듈로 교체

### 변경 파일
- `requirements.txt`
- `src/til_server/prompts.py`
- `src/til_server/resources.py`
- `src/til_server/server.py`
- `src/til_server/storage.py`
- `src/til_server/tools.py`

---

## 10:49 (auto)

### 작업 내용
- feat: TIL_REPO_PATH 환경변수로 저장 레포 분리 지원
- MCP 서버 등록 시 TIL_REPO_PATH를 주입하면
- 서버 코드와 데이터 레포를 분리할 수 있다.

### 변경 파일
- `src/til_server/storage.py`
- `src/til_server/tools.py`

---

## 10:51 (auto)

### 작업 내용
- chore: pyproject.toml 추가 및 til-server CLI entry point 설정
- uvx로 설치 없이 바로 실행 가능하도록 패키지 구성

### 변경 파일
- `pyproject.toml`
- `src/til_server/server.py`

---

## 11:01 (auto)

### 작업 내용
- refactor: save_discussion_recap 제거, create_til로 통합
- 두 툴의 역할이 중복되어 create_til 하나로 통합.
- docstring에 대화 요약 저장 용도도 명시.

### 변경 파일
- `src/til_server/prompts.py`
- `src/til_server/tools.py`

---

## 11:04 (auto)

### 작업 내용
- docs: README 전면 재작성 — 설치 가이드 및 기능 정리
- uvx 기반 설치, Windows 포함, GitHub 저장소 방식으로 업데이트

### 변경 파일
- `README.md`

---

## 11:09 (auto)

### 작업 내용
- feat: GitHub API 기반 TIL 저장소 모듈 추가
- urllib.request만 사용해 외부 의존성 없이 GitHub contents API로
- TIL 마크다운 파일 CRUD 구현. GITHUB_TOKEN 또는 gh auth token으로
- 인증, TIL_GITHUB_REPO 또는 자동 감지로 레포 설정.

### 변경 파일
- `src/til_server/github_storage.py`

---

## 11:10 (auto)

### 작업 내용
- refactor: storage.py를 github_storage 래퍼로 교체, tools.py 정리
- 기존 import 경로 유지를 위해 storage.py를 github_storage 재노출 모듈로
- 변환. tools.py에서 로컬 파일 경로(_TIL_REPO, Path) 관련 코드 제거.

### 변경 파일
- `src/til_server/storage.py`
- `src/til_server/tools.py`

---

## 11:16

### 요청사항
- til-server MCP가 Local scope로 등록된 이유 파악 및 user scope 이동
- README.md에 `-s user` 플래그 설치 안내 추가

### 작업 내용
- `~/.claude.json`에서 til-server를 project scope → user scope로 이동
- README.md 모든 `claude mcp add` 명령에 `-s user` 플래그 추가
- 주의사항 안내 문구 추가

### 작업 내용
- docs: MCP 등록 명령에 -s user 플래그 추가
- 모든 프로젝트에서 사용 가능하도록 user scope 설치 방법으로 안내.
- 플래그 없이 설치 시 project scope에 등록되는 점도 명시.

### 변경 파일
- `README.md`: `claude mcp add` 명령에 `-s user` 플래그 및 안내 문구 추가

### 토큰 사용량
- 모델: claude-sonnet-4-6
- 이번 작업: 34,463,169 토큰 / $21.07 (전체 누적, 스냅샷 없음)
- 소요 시간: 측정 불가
- 일일 누적: 34,463,169 토큰 / $21.07

---

## 11:19

### 요청사항
- MCP 설명/기능 최신화 여부 확인 및 수정

### 작업 내용
- server.py, resources.py 주석 4곳이 실제 구현과 불일치함을 확인
- storage 설명 "파일 기반" → "GitHub API 기반", discussion_recap 툴 제거, 디렉토리 초기화 설명 수정, 이번 주(월~일) → 최근 7일간 수정

### 작업 내용
- docs: MCP 설명 주석 최신화 (GitHub API 기반으로 수정)
- storage 설명 "파일 기반" → "GitHub API 기반",
- discussion_recap 툴 목록에서 제거 (프롬프트로만 존재),
- 디렉토리 초기화 주석 수정, 이번 주(월~일) → 최근 7일간

### 변경 파일
- `src/til_server/server.py`: storage 설명, tools 목록, 초기화 주석 수정
- `src/til_server/resources.py`: list_week_tils 설명 "이번 주(월~일)" → "최근 7일간"

### 토큰 사용량
- 모델: claude-sonnet-4-6
- 이번 작업: 1,537,670 토큰 / $0.67
- 소요 시간: 측정 불가
- 일일 누적: 36,000,839 토큰 / $21.74

---

## 11:22

### 요청사항
- README.md 최신화 여부 확인 및 수정

### 작업 내용
- README Resources 표에서 `til://list/week` 설명 "이번 주 기록" → "최근 7일 기록"으로 수정

### 작업 내용
- docs: README til://list/week 설명 최신화
- "이번 주 기록" → "최근 7일 기록" (실제 구현과 일치)

### 변경 파일
- `README.md`: `til://list/week` 설명 최신화

### 토큰 사용량
- 모델: claude-sonnet-4-6
- 이번 작업: 데이터 없음
- 소요 시간: 1분
- 일일 누적: 데이터 없음

---

## 11:27

### 요청사항
- ENABLE_TOOL_SEARCH로 인해 TIL MCP 툴이 자동 사용 안 되는 문제 해결

### 작업 내용
- FastMCP `instructions` 파라미터로 서버 목적 명시 (공식 문서 확인 후 적용)
- 기록 요청 시 create_til 사용, 조회는 til://list, 검색은 search_til 안내 포함

### 작업 내용
- feat: FastMCP instructions 추가로 TIL 기록 자동 유도
- ENABLE_TOOL_SEARCH=true 환경에서 deferred 툴이 자동 호출되지 않는 문제 해결.
- 서버 instructions로 create_til/search_til/til://list 사용 시점을 명시.

### 변경 파일
- `src/til_server/server.py`: FastMCP 생성 시 instructions 파라미터 추가

### 토큰 사용량
- 모델: claude-sonnet-4-6
- 이번 작업: 데이터 없음
- 소요 시간: 2분
- 일일 누적: 데이터 없음

---

## 11:28

### 요청사항
- 서버 업데이트 시 다른 컴퓨터에서 자동 반영되도록 설치 명령 개선

### 작업 내용
- `uvx --refresh` 플래그 추가로 Claude Code 시작 시마다 최신 버전 자동 반영
- README 설치 명령 3곳 모두 업데이트

### 작업 내용
- docs: uvx --refresh 플래그 추가로 자동 업데이트 지원
- Claude Code 시작 시마다 최신 서버 버전을 자동으로 받아오도록
- 설치 명령 전체에 --refresh 플래그 추가.

### 변경 파일
- `README.md`: uvx 명령에 `--refresh` 플래그 추가 (3곳)

### 토큰 사용량
- 모델: claude-sonnet-4-6
- 이번 작업: 데이터 없음
- 소요 시간: 1분
- 일일 누적: 데이터 없음

---

## 11:35

### 요청사항
- PyPI에 패키지 배포해서 `uvx til-server`로 설치 가능하게

### 작업 내용
- `uv build && uv publish`로 PyPI 배포 완료 (v0.1.0)
- README 설치 명령 `uvx til-server`로 단순화 (3곳)

### 작업 내용
- feat: PyPI 배포 및 설치 명령 단순화
- til-server v0.1.0 PyPI 배포 완료.
- 설치 명령이 uvx til-server 한 줄로 단순해지고
- uvx가 자동으로 최신 버전을 관리함.

### 변경 파일
- `README.md`: 설치 명령 `uvx --refresh --from git+...` → `uvx til-server`로 변경

### 토큰 사용량
- 모델: claude-sonnet-4-6
- 이번 작업: 데이터 없음
- 소요 시간: 1분
- 일일 누적: 데이터 없음

---

## 11:38

### 요청사항
- pypi.txt를 .gitignore에 추가해서 토큰 파일이 커밋되지 않도록

### 작업 내용
- .gitignore에 pypi.txt 추가

### 변경 파일
- `.gitignore`: pypi.txt 추가

### 토큰 사용량
- 모델: claude-sonnet-4-6
- 이번 작업: 데이터 없음
- 소요 시간: 1분
- 일일 누적: 데이터 없음
